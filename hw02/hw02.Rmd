---
title: "hw02"
author: "Joanna Lawler"
date: Last updated `r format(Sys.time(), "%d %B, %Y")`
output: 
  html_document:
    keep_md: TRUE
    theme: cerulean
    toc: TRUE
---

```{r load packages, warning = FALSE}
# install.packages('moments')
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(gapminder))
suppressPackageStartupMessages(library(moments))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(tsibble))
knitr::opts_chunk$set(fig.align = "center")
options(knitr.table.format = 'markdown')
```

# 1.1 & 1.2

First, I used the filter() function to subset the gapminder data to the three countries of my choice in the 1970s: Cambodia, the United States, and Vietnam. Next, I used the pipe operator to select the "country" and "gdpPercap" variables from my filtered dataset.

```{r echo = FALSE}
gapminder_p1_2 <- gapminder %>%
  filter(year > 1969, year < 1980, country %in% c("Cambodia", "United States", "Vietnam")) %>%
  select(country, gdpPercap)

DT::datatable(gapminder_p1_2)
```

# 1.3

After using the lag() function to compute lifeExp_change, a new variable in my tibble that is the change in life expectancy, I filtered the gapminder data to all entries that experienced a drop in life expectancy.

```{r echo = FALSE}
gapminder_p1_3 <- gapminder %>%
  arrange(year) %>%
  group_by(country) %>%
  mutate(lifeExp_change = lifeExp - lag(lifeExp)) %>%
  tidyr::drop_na() %>%
  filter(lifeExp_change < 0)

DT::datatable(gapminder_p1_3)
```

# 1.4

Using the max() function, I filtered the gapminder data to show the maximum GDP per capita experienced by each country.

```{r echo = FALSE}
gapminder_p1_4 <- gapminder %>%
  group_by(country) %>%
  filter(gdpPercap == max(gdpPercap))

DT::datatable(gapminder_p1_4)
```

# 1.5

After using the filter() function to subset the gapminder data to Canada, I piped the data directly into the ggplot() function to produce a scatterplot of the country's life expectancy vs. GDP per capita on a log scale.

```{r echo = FALSE}
gapminder_p1_5 <- gapminder %>%
  filter(country %in% c("Canada")) %>%
  ggplot(aes(gdpPercap, lifeExp)) +
  geom_point() +
  scale_x_log10("GDP Per Capita", labels = scales::comma_format()) +
  ylab("Life Expectancy")

print(gapminder_p1_5)
```

# 2

Using the gapminder data, I chose to explore country, a categorical variable, and lifeExp, a quantitative variable.

Country is a categorical variable with 142 levels. Most of the levels of this variable are, in fact, countries of the world that range alphabetically from Afghanistan to Zimbabwe. However, it appears that there are three exceptions: Hong Kong, Réunion, and West Bank and Gaza. Hong Kong is a city and special administrative region of China, Réunion is an island in the Indian Ocean that is an overseas department and region of the French Republic, and the West Bank and Gaza constitute the State of Palestine, which has not been recognized by some United Nations Member Nations (iincluding the United States).

Out of these 142 countries (and other terrirtories), 52 are located in Africa, 25 are located in the Americas, 33 are located in Asia, 30 are located in Europe, and two are located in Oceania (a geographic region that includes Australasia, Melanesia, Micronesia and Polynesia).

```{r echo = FALSE}
gapminder_p2_1 <- gapminder %>%
  group_by(continent) %>%
  summarize(n_obs = n(), n_countries = n_distinct(country))

DT::datatable(gapminder_p2_1)
```

lifeExp is a quantitative variable that is a measure of life expectancy in years. It ranges from 23.599 years to 82.603 years. The mean life expectancy across all data points is 59.47 years, whereas the median is 60.71. Based on the variable's skewness (-0.25) and kurtosis (1.87) alone, the variable seems to be relatively normally distributed. However, a histogram reveals that its distribution is bimodal.

Across the timepoints, people living in the the 52 African countries had the lowest life expectancy (median = 47.79, SD = 9.15), whereas people in the two Oceanic countries, New Zealand and Australia, had the highest (median = 73.67, SD = 3.80). Life expectancy across all of the countries increased steadily across all of the timepoints such that it was lowest in 1952 (median = 45.14, SD = 12.23) and highest in 2007 (median = 71.94, SD = 12.07). Unsurprisingly, people living in countries where warfare and genocide occurred between 1952 and 2007 tended to have lower life expectancies; for example, the lowest life expectancy (mean = 23.60) was observed in Rwanda in 1992 during the Rwandan Civil War. The country whose inhabitants had the highest life expectancy across all of the timepoints was Iceland (median = 76.55; SD = 3.03).

```{r echo = FALSE}
gapminder_p2_2 <- gapminder %>%
  summarize(mu = mean(lifeExp),
            sigma = sd(lifeExp),
            med = median(lifeExp),
            skew = skewness(lifeExp),
            kurt = kurtosis(lifeExp),
            min = min(lifeExp),
            max = max(lifeExp))

DT::datatable(gapminder_p2_2)

gapminder_p2_3 <- gapminder %>%
  ggplot(aes(lifeExp)) +
  geom_histogram(binwidth = 1)

print(gapminder_p2_3)

gapminder_p2_4 <- gapminder %>% 
  group_by(continent) %>% 
  summarize(mu = mean(lifeExp),
            med = median(lifeExp),
            sigma = sd(lifeExp)) %>%
  arrange(med)

DT::datatable(gapminder_p2_4)

gapminder_p2_5 <- gapminder %>% 
  group_by(year) %>% 
  summarize(mu = mean(lifeExp),
            med = median(lifeExp),
            sigma = sd(lifeExp)) %>%
  arrange(med)

DT::datatable(gapminder_p2_5)

gapminder_p2_6 <- gapminder %>% 
  group_by(country) %>%
  summarize(mu = mean(lifeExp),
            med = median(lifeExp),
            sigma = sd(lifeExp)) %>%
  arrange(med)

DT::datatable(gapminder_p2_6)

gapminder_p2_7 <- gapminder %>%
  filter(country %in% c("Rwanda")) %>%
  group_by(year) %>% 
  summarize(mu = mean(lifeExp),
            med = median(lifeExp))

DT::datatable(gapminder_p2_7)
```

# 3

ChickWeight is a dataset that examines the effect of diet on early growth of 48 chicks. Diet is a between-subjects variable with four different levels, but more information is not disclosed. The weight of the chicks was first measured on the day that they were born. Then, they were weighed every other day throughout the following three weeks, with the final measure taken 21 days after their birth.

The first plot that I generated is a scatterplot with a regression line that has Days Since Birth on the x axis and Weight in grams on the y axis. The plot shows a pretty positive linear relationship between weight and time, such that the weight of the entire sample of chicks increased as the number of days since birth increased.

The second plot that I generated is a boxplot with points that looks at the relationship between diet and weight at the final measurement taken 21 days after the birth of the chicks. It illustrates that the chicks on Diet 3 (whatever that may be) weighted the most on the final day (median = 281 grams, SD = 71.62 grams). Chicks on Diet 1 weighed the least (median = 166 grams, SD = 58.70 grams), whereas chicks on Diets 2 and 4 had similar weights (median = 212.5, SD = 78.14 grams; median = 237 grams, SD = 43.35 grams respectively).

```{r echo = FALSE}
library(help = "datasets")
data("ChickWeight")

ChickWeight %>%
  ggplot(aes(Time, weight)) +
  geom_point(aes(Time, weight, color = Diet), alpha = 0.2) +
  geom_smooth(method = "lm", se = FALSE) +
  xlab("Days Since Birth") +
  ylab("Weight (gm)") +
  labs("Diet")
  
ChickWeight %>%
  filter(Time == 21) %>% 
  ggplot(aes(Diet, weight, group = Diet, fill = Diet)) +
  geom_boxplot() +
  geom_point(alpha = 0.2) +
  xlab("Diet") +
  ylab("Weight (gm)") +
  guides(fill = FALSE)

chickweight_p3 <- ChickWeight %>%
  filter(Time == 21) %>% 
  group_by(Diet) %>% 
  summarize(mu = mean(weight),
            med = median(weight),
            sigma = sd(weight))

DT::datatable(chickweight_p3)
```